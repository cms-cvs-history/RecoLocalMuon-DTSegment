##
# Testthe production of the complete chain:
# from digi to RecSegment 4D, through RecHit1D and RecSegment2D
#
# HOW TO use it
#
# Please refer to the header of testDTRecSegment2DProducer.cfg
# and testDTRecSegment2DProducer.cfg
##

process PROD  = {
	
	source = PoolSource{
# untracked vstring fileNames ={'file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/samples/tutorial/muondigi_tutorial.root'}
untracked vstring fileNames ={'file:/afs/cern.ch/cms/data/CMSSW/Tutorials/May06CPTweekTutorials/MuonReconstruction/muondigi_tutorial_20to100GeV.root'}
		            untracked int32 maxEvents = -1
		  	    untracked uint32 debugVebosity = 10
                	    untracked bool   debugFlag     = true
        		   }

        include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

	## DT Geometry
        include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
        include "Geometry/DTGeometry/data/dtGeometry.cfi"
	## CSC Geometry
	include "Geometry/CSCGeometry/data/cscGeometry.cfi"

#------------------------------------ DT ------------------------------------------------

	## _Vdrift1D_ ##
	include "RecoLocalMuon/DTRecHit/data/dt1DRecHit_parametrizedDrift.cfi"
#	include "RecoLocalMuon/DTRecHit/data/dt1DRecHit_linearDrift.cfi"

	## _Vdrift2D_ ##
	include "RecoLocalMuon/DTSegment/data/dt2DRecHit_ParamDrift.cfi"
#	include "RecoLocalMuon/DTSegment/data/dt2DRecHit_LinearDrift.cfi"

	## _4DAlgo ##
	include "RecoLocalMuon/DTSegment/data/dt4DRecHit_CombPatternReco_ParamDrift.cfi"
#	include "RecoLocalMuon/DTSegment/data/dt4DRecHit_CombPatternReco_LinearDrift.cfi"
#    	include "RecoLocalMuon/DTSegment/data/dt4DRecHit_RefitAndCombine.cfi"

	## _all1DHits_ ##	
	# CAVEAT if all1DHits = false: 
	#	1- the file must contain the 2D segments
	#	2- defined only for CombinatorialPatternReco
#	replace recseg4dbuilder.Reco4DAlgoConfig.AllDTRecHits = false

#------------------------------------ CSC -----------------------------------------------
	
	## 2D RecHit	
	include "RecoLocalMuon/CSCRecHit/data/cscRecHit2DProducer.cfi"

	## Segments
	include "RecoLocalMuon/CSCSegment/data/cscSegProducer.cfi"

#----------------------------------------------------------------------------------------

	module out = PoolOutputModule {
				       untracked string fileName ="/tmp/MuonRecHit.root"
		  		      }

#------------------------------------ Analyzers ------------------------------------------

module recseg2danalyzer = DTRecSegment2DReader {
						untracked bool debug = true
				 		untracked string rootFileName = "dtseg2D_plot.root"
						string recHits2DLabel = "recseg2dbuilder"
	 				       }


module recseg4danalyzer = DTRecSegment4DReader {
						untracked bool debug = true
				 		untracked string rootFileName = "dtseg4D_plot.root"
						string recHits4DLabel = "recseg4dbuilder"
	 				       }

module cscSegmentReader = CSCSegmentReader {
        				    untracked string RootFileName = "cscseg_plot.root"
					    untracked int32 minRechitPerChamber = 3
					    untracked int32 minRechitPerSegment = 3
					    untracked string label1 = ""	
					   }


	## _ExecPath_ ##
#	path p = {dtrechitbuilder, recseg2dbuilder,recseg4dbuilder,rechitproducer,segmentproducer}
	path p = {dtrechitbuilder, recseg2dbuilder,recseg4dbuilder,rechitproducer,segmentproducer,recseg2danalyzer,recseg4danalyzer,cscSegmentReader}

	endpath this_is_the_end = {out}
}

 
