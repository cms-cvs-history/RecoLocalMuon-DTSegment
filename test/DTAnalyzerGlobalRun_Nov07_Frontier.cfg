
# Test the production of the complete chain:
# from digi to RecSegment 4D, through RecHit1D and RecSegment2D
# starting from real cosmic data from commissioning
# Up to now only the Linear Drift alogo is available for the
# commisioning data.
##

process testDTAnalyzer  = {


  include "CondCore/DBCommon/data/CondDBSetup.cfi"

############################################################################################    
#                 F I L E   R E A D E R 
############################################################################################    

# Event Formatter
    untracked PSet maxEvents = {
      untracked int32 input = 100
    }

  source = PoolSource {
    untracked string fileMatchMode = "permissive"
      untracked uint32 firstRun = 0
      untracked uint32 firstEvent = 0
      untracked uint32 skipEvents = 0
      untracked vstring fileNames = {
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/0C3C47B7-E5A4-DC11-B9DA-000423D94DE8.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/34D317AD-E7A4-DC11-BE0F-001617DBD49E.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/3604EA55-E9A4-DC11-9761-00304885B41C.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/40CBB500-E8A4-DC11-BB8F-001617DBD25A.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/4AE9889E-E5A4-DC11-9505-001617DBD2FA.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/4CF7DDB0-E6A4-DC11-87C0-000423D665B2.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/5EE3AB39-E7A4-DC11-BBA8-00304885B4C8.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/60BA58C1-E8A4-DC11-977D-001617C3B652.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/620E3735-E6A4-DC11-9FF3-003048562914.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/68B11A6F-E8A4-DC11-B264-000423D6101A.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/6A8A6ED8-E6A4-DC11-9C97-001617C3B614.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/747B038F-E6A4-DC11-9189-00304885AAC4.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/86B2A6A8-E5A4-DC11-A7D4-000E0C3F097F.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/8A9CA88E-E7A4-DC11-9076-001617DBD558.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/9434A415-E6A4-DC11-9B9B-000423D994CC.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/9A300385-E8A4-DC11-8599-001617DBD356.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/9A5811CF-E5A4-DC11-9F16-001617C3B652.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/A88B695A-E9A4-DC11-901A-001617DBCFB0.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/ACAB6E50-E8A4-DC11-A851-00304885B32C.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/B8302343-E7A4-DC11-8A6C-000423D6B1A4.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/CABC551F-EAA4-DC11-BCDE-000423D567F0.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/DC3C3D41-E5A4-DC11-B3CF-00304885AAC8.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/DE038C1C-E8A4-DC11-BD69-000423DD3410.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/DE652DAF-E8A4-DC11-88F0-000423D94C80.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/DE79328E-E6A4-DC11-88F7-000423D94EA0.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/E0B85861-E8A4-DC11-8A1E-001617C3B66A.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/E4434767-E7A4-DC11-B281-001617DBD5C4.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/E814CDF1-E8A4-DC11-ADE4-001617C3B77E.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/FAA5EF17-E9A4-DC11-BFF2-001617DBD558.root',
        '/store/data/GlobalNov07/A/000/030/625/RAW/0000/FC2F0659-E7A4-DC11-AB14-000423D59C46.root'
      }
  }

  service = MessageLogger {
    untracked vstring destinations = { "cout" }
    untracked vstring debugModules = { "*" }
    untracked PSet cout = {
      untracked string threshold = "WARNING"
        untracked bool noLineBreaks = true
        untracked PSet WARNING = {untracked int32 limit = 0 }
    }
  }

############################################################################################    
#
#                 D T   U N P A C K I N G  
#
############################################################################################    

 module dtunpacker = DTUnpackingModule {
    string dataType = "DDU"
    untracked bool fedbyType = true
    untracked bool useStandardFEDid = true
    PSet readOutParameters  = {
        untracked bool localDAQ = false
        untracked bool performDataIntegrityMonitor = false
        untracked bool debug = false
        PSet rosParameters = {
            untracked bool localDAQ = false
            untracked bool readingDDU = true
            untracked bool writeSC = true
            untracked bool readDDUIDfromDDU = true
            untracked bool performDataIntegrityMonitor = false
            untracked bool debug = false
        }
    }
 }

 es_source DTMapping = PoolDBESSource {
   string timetype = "runnumber"

     string connect = "frontier://Frontier/CMS_COND_ON_170_DT"
     untracked string catalog = ""
     untracked bool siteLocalConfig = true


     string record = "DTReadOutMappingRcd"
     string tag = "DTChannelsMap"
     PSet DBParameters = {
       untracked int32 messageLevel = 0
        # untracked string authenticationPath = "/afs/cern.ch/cms/DB/conddb"
     }

   VPSet toGet = {
     { string record = "DTReadOutMappingRcd"
       string tag = "GRENmap_774" },
     { string record = "DTT0Rcd"
       string tag = "GRENt0" }  ,
     { string record = "DTTtrigRcd"
       string tag = "GRENttrigTest" }
   }
   
 }


  include "CondCore/DBCommon/data/CondDBSetup.cfi"

############################################################################################    
#
#                 R E C O N S T R U C T I O N 
#
############################################################################################    


    include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"
#include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
    include "Geometry/DTGeometry/data/dtGeometry.cfi"
    include "Geometry/CSCGeometry/data/cscGeometry.cfi"
    include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi"

    include "RecoLocalMuon/DTRecHit/data/dt1DRecHits_LinearDrift_CosmicData.cfi"
    include "RecoLocalMuon/DTSegment/data/dt2DSegments_CombPatternReco2D_LinearDrift_CosmicData.cfi"
    replace dt2DSegments.debug=false
    replace DTCombinatorialPatternReco2DAlgo_LinearDrift_CosmicData.Reco2DAlgoConfig.debug=false
    include "RecoLocalMuon/DTSegment/data/dt4DSegments_CombPatternReco4D_LinearDrift_CosmicData.cfi"


## Geometry
    include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"
    include "MagneticField/Engine/data/uniformMagneticField.cfi"
    include "RecoMuon/DetLayers/data/muonDetLayerGeometry.cfi"
    include "RecoMuon/MuonSeedGenerator/data/CosmicMuonSeedProducer.cfi"
    replace CosmicMuonSeed.EnableCSCMeasurement = false
    include "RecoMuon/CosmicMuonProducer/data/cosmicMuons.cfi"
    replace cosmicMuons.TrajectoryBuilderParameters.EnableDTMeasurement = true
    replace cosmicMuons.TrajectoryBuilderParameters.EnableCSCMeasurement = false
    replace cosmicMuons.TrajectoryBuilderParameters.EnableRPCMeasurement = false
#replace cosmicMuons.TrajectoryBuilderParameters.BackwardMuonTrajectoryUpdatorParameters.Granularity= 0

    include "TrackPropagation/SteppingHelixPropagator/data/SteppingHelixPropagator.cfi"

# ===================================================
#  7) configuration of your analyzer
# ===================================================

    include "RecoLocalMuon/DTSegment/test/DTFilter.cfi"

## Hits and Segs ##
    include "RecoLocalMuon/DTSegment/test/DTAnalyzer.cfi"

## Segs ##
    include "RecoLocalMuon/DTSegment/test/DTSegAnalyzer.cfi"

## StandAlone ##
    include "RecoLocalMuon/DTSegment/test/STAnalyzer.cfi"

## Segs Eff ##
    include "RecoLocalMuon/DTSegment/test/DTEffAnalyzer.cfi"

#sequence localreco = {dtunpacker, dt1DRecHits, dt2DSegments, dt4DSegments}
  sequence localreco = {dtunpacker, dt1DRecHits, dt2DSegments, dt4DSegments}
  sequence cosmic = {CosmicMuonSeed, cosmicMuons}
  #sequence ana = {DTAnalyzer, DTEffAnalyzer, DTSegAnalyzer, STAnalyzer }
  sequence ana = {DTSegAnalyzer}
  #path p = {DTFilter & (localreco, cosmic, ana)}
  path p = {DTFilter & (localreco, ana)}
  #path p = {DTFilter & (localreco, cosmic, DTSegAnalyzer)}
  #path p = {DTFilter & (localreco, cosmic) }
  #path p = {DTFilter & (localreco, DTSegAnalyzer)}

#   service = VisConfigurationService {
# ##########
# # Number of various windows to be popped up and tiled.
# # Default value is 'RPhi Window'
# #
# # untracked vstring Views = {'3D Window', 'Lego Window', 'RPhi Window', 'RZ Window'}
#     untracked vstring Views = {'3D Window'}

# # #########
# # Which context data proxies to load (the default value is defined
# # in VisApplicationMain and usually loads all available data proxies):
#     untracked vstring  ContentProxies =
#     {'Reco/Detector', 'Reco/MuonDT', 'Reco/Trigger', 'Reco/Muon'}
#     # untracked vstring  ContentProxies =
#     # {'Reco/Detector','Reco/Hcal', 'Reco/MuonDT', 'Reco/MuonCSC',
#     #   'Reco/Trigger', 'Reco/Calorimetry', 'Reco/Ecal', 'Reco/Muon'}

#     untracked vstring  EnabledTwigs = {
#       # '/Objects/CMS Event and Detector/HCAL Event/Hcal Barrel and Endcap RecHits',
#       # '/Objects/CMS Event and Detector/HCAL Event/Hcal Forward RecHits',
#       # '/Objects/CMS Event and Detector/ECAL Event/Rec hits',
#       # '/Objects/CMS Event and Detector/Muon DT Event/DT Digis',
#       '/Objects/CMS Event and Detector/Muon DT Event/DT Hits',
#       '/Objects/CMS Event and Detector/Muon DT Event/DT 2DSegment',
#       '/Objects/CMS Event and Detector/Muon DT Event/DT 4DSegment',
#       '/Objects/CMS Event and Detector/DTs/Wheel 0'
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 1',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 2',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 3',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 4',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 5',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 6',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 7',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 8',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 9',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 10',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 11',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 12',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 13',
#       # '/Objects/CMS Event and Detector/DTs/Wheel 0/Sector 14'
#     }
#   }


}

